<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SDG 5 vs Female Homicide Rates â€“ Ireland, South Africa, United States</title>
    <script src="https://cdn.plot.ly/plotly-2.4.1.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        html, body { margin: 0; padding: 0; height: 100%; width: 100%; background: white; }
        #plot { width: 100%; height: 100vh; }
    </style>
</head>
<body>

<div id="plot"></div>

<script type="text/javascript">

    var irelandTrace = {
        x: [72.5, 75.9, 76.1, 76.3, 76.4, 76.5, 77.2, 77.7],
        y: [0.2946, 0.0833, 0.6176, 0.4066, 0.2811, 0.2385, 0.2757, 0.4264],
        mode: "markers",
        name: "Ireland",
        marker: { color: "#636efa", size: 12 }
    };

    var saTrace = {
        x: [81.4, 82.0, 78.2, 76.7, 76.7, 76.8],
        y: [8.9521, 9.8553, 9.1719, 8.7797, 10.2846, 12.2036],
        mode: "markers",
        name: "South Africa",
        marker: { color: "#EF553B", size: 12 }
    };

    var usTrace = {
        x: [71.6, 71.5, 72.2, 74.3, 74.4, 76.5, 76.6, 76.8],
        y: [2.049, 2.266, 2.233, 2.216, 2.136, 2.578, 3.004, 2.809],
        mode: "markers",
        name: "United States",
        marker: { color: "#00cc96", size: 12 }
    };


    var X = irelandTrace.x.concat(saTrace.x, usTrace.x);
    var Y = irelandTrace.y.concat(saTrace.y, usTrace.y);

    function linearRegression(x, y) {
        var n = x.length;
        var sumX = 0, sumY = 0, sumXY = 0, sumXX = 0;

        for (var i = 0; i < n; i++) {
            sumX += x[i];
            sumY += y[i];
            sumXY += x[i] * y[i];
            sumXX += x[i] * x[i];
        }

        var slope = (n*sumXY - sumX*sumY) / (n*sumXX - sumX*sumX);
        var intercept = (sumY - slope*sumX) / n;

        return { slope: slope, intercept: intercept };
    }

    var reg = linearRegression(X, Y);

    var minX = Math.min(...X);
    var maxX = Math.max(...X);

    var regLine = {
        x: [minX, maxX],
        y: [reg.slope * minX + reg.intercept, reg.slope * maxX + reg.intercept],
        mode: "lines",
        name: "OLS Regression Line",
        line: { color: "#ab63fa", width: 3 }
    };

    var data = [irelandTrace, saTrace, usTrace, regLine];

    var layout = {
        title: "SDG 5 Scores vs Female Homicide Rates (OLS Regression Line)",
        xaxis: { title: "SDG 5 Score" },
        yaxis: { title: "Female homicide rate per 100,000" }
    };

    Plotly.newPlot("plot", data, layout, {responsive: true});

</script>

</body>
</html>
